# Disable directory browsing
Options -Indexes

# Protect sensitive file types
<FilesMatch "\.(htaccess|htpasswd|ini|log|conf|env)$">
  Require all denied
</FilesMatch>

# Prevent access to hidden files and folders (starting with a dot)
RedirectMatch 404 /\..*$

# Block script execution only in uploads folder (adjust path if needed)
<Directory "/uploads">
  <FilesMatch "\.(php|php5|php7|phtml|phar)$">
    Require all denied
  </FilesMatch>
</Directory>

# Secure cross-site scripting (XSS) protection
Header set X-XSS-Protection "1; mode=block"

# Prevent MIME-type sniffing
Header set X-Content-Type-Options "nosniff"

# Clickjacking protection
Header always append X-Frame-Options SAMEORIGIN

# Referrer Policy
Header set Referrer-Policy "strict-origin-when-cross-origin"

# Disable caching for sensitive files
<FilesMatch "\.(php|html)$">
  Header set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
  Header set Pragma "no-cache"
</FilesMatch>
